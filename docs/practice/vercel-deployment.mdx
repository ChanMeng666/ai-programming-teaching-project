---
sidebar_position: 4
title: Verceléƒ¨ç½²å®è·µ
description: å­¦ä¹ å¦‚ä½•å°†åšå®¢é¡¹ç›®éƒ¨ç½²åˆ°Vercelå¹³å°
---

import Tabs from '@theme/Tabs';
import TabItem from '@theme/TabItem';

# Verceléƒ¨ç½²å®è·µ

## éƒ¨ç½²å‡†å¤‡

### é¡¹ç›®ä¼˜åŒ–

<div className="optimization">

#### 1. æ„å»ºä¼˜åŒ–
```json
// next.config.js
module.exports = {
  swcMinify: true,
  images: {
    domains: ['your-image-domain.com'],
  },
  experimental: {
    optimizeCss: true,
    optimizeImages: true,
  },
}
```

#### 2. æ€§èƒ½æ£€æŸ¥
```bash
# è¿è¡Œæ€§èƒ½æ£€æŸ¥
npm run build
npm run analyze # éœ€è¦å®‰è£…@next/bundle-analyzer

# æ£€æŸ¥æ„å»ºè¾“å‡º
ls -lh .next/static/chunks/
```

#### 3. ç¯å¢ƒå˜é‡é…ç½®
```env
# .env.production
NEXT_PUBLIC_API_URL=https://api.yourblog.com
NEXT_PUBLIC_SITE_URL=https://yourblog.com
DATABASE_URL=your_database_url
```

</div>

## éƒ¨ç½²æµç¨‹

### åˆå§‹éƒ¨ç½²

<div className="deployment-steps">

#### 1. è¿æ¥ä»“åº“

<Tabs>
  <TabItem value="ui" label="ä½¿ç”¨UI" default>
    1. ç™»å½•Vercelæ§åˆ¶å°
    2. ç‚¹å‡»"New Project"
    3. å¯¼å…¥Gitä»“åº“
    4. é…ç½®é¡¹ç›®è®¾ç½®
  </TabItem>
  <TabItem value="cli" label="ä½¿ç”¨CLI">
    ```bash
    # å®‰è£…Vercel CLI
    npm i -g vercel

    # ç™»å½•
    vercel login

    # éƒ¨ç½²
    vercel
    ```
  </TabItem>
</Tabs>

#### 2. éƒ¨ç½²é…ç½®

```json
// vercel.json
{
  "version": 2,
  "builds": [
    {
      "src": "package.json",
      "use": "@vercel/next"
    }
  ],
  "routes": [
    {
      "src": "/api/.*",
      "headers": {
        "Access-Control-Allow-Origin": "*"
      }
    }
  ]
}
```

</div>

### è‡ªåŠ¨éƒ¨ç½²é…ç½®

<div className="auto-deployment">

#### GitHub Actionsé…ç½®
```yaml
# .github/workflows/deploy.yml
name: Deploy to Vercel
on:
  push:
    branches: [main]
  pull_request:
    branches: [main]

jobs:
  deploy:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v2
      
      - name: Install Dependencies
        run: npm ci
      
      - name: Run Tests
        run: npm test
      
      - name: Deploy to Vercel
        if: success()
        run: npx vercel --token ${VERCEL_TOKEN}
        env:
          VERCEL_TOKEN: ${{ secrets.VERCEL_TOKEN }}
          VERCEL_PROJECT_ID: ${{ secrets.VERCEL_PROJECT_ID }}
          VERCEL_ORG_ID: ${{ secrets.VERCEL_ORG_ID }}
```

#### åˆ†æ”¯é¢„è§ˆ
```javascript
// scripts/comment-on-pr.js
async function commentOnPR(deployment) {
  const { GITHUB_TOKEN, PR_NUMBER } = process.env;
  const comment = `
ğŸš€ Preview deployment is ready!
URL: ${deployment.url}
Branch: ${deployment.git.branch}
Commit: ${deployment.git.commitSha}
  `;
  
  // ä½¿ç”¨GitHub APIå‘é€è¯„è®º
  // ...
}
```

</div>

## åŸŸåé…ç½®

### DNSè®¾ç½®

<div className="dns-setup">

#### æ·»åŠ åŸŸå
1. åœ¨Vercelé¡¹ç›®è®¾ç½®ä¸­æ·»åŠ åŸŸå
2. é…ç½®DNSè®°å½•ï¼š

```bash
# Aè®°å½•
Type: A
Name: @
Value: 76.76.21.21

# CNAMEè®°å½•
Type: CNAME
Name: www
Value: cname.vercel-dns.com
```

#### SSLé…ç½®
```json
{
  "headers": [
    {
      "source": "/(.*)",
      "headers": [
        {
          "key": "Strict-Transport-Security",
          "value": "max-age=31536000; includeSubDomains"
        }
      ]
    }
  ]
}
```

</div>

## ç›‘æ§å’Œä¼˜åŒ–

### æ€§èƒ½ç›‘æ§

<div className="monitoring">

#### Web Vitalsç›‘æ§
```typescript
// lib/analytics.ts
import { Analytics } from '@vercel/analytics';

export function reportWebVitals({ id, name, label, value }) {
  Analytics.track(name, {
    id,
    label,
    value,
    page: window.location.pathname,
  });
}
```

#### æ€§èƒ½é¢„ç®—è®¾ç½®
```json
// performance-budget.json
{
  "resourceSizes": [
    {
      "resourceType": "script",
      "budget": 300
    },
    {
      "resourceType": "total",
      "budget": 1000
    }
  ],
  "resourceCounts": [
    {
      "resourceType": "third-party",
      "budget": 10
    }
  ]
}
```

</div>

### é”™è¯¯ç›‘æ§

<div className="error-tracking">

#### Sentryé›†æˆ
```typescript
// lib/sentry.ts
import * as Sentry from '@sentry/nextjs';

Sentry.init({
  dsn: process.env.NEXT_PUBLIC_SENTRY_DSN,
  tracesSampleRate: 1.0,
  environment: process.env.NODE_ENV,
  integrations: [
    new Sentry.Integrations.BrowserTracing({
      tracingOrigins: ['localhost', 'yourblog.com'],
    }),
  ],
});

export function captureException(error: Error, context?: any) {
  Sentry.withScope((scope) => {
    if (context) {
      scope.setExtras(context);
    }
    Sentry.captureException(error);
  });
}
```

#### é”™è¯¯è¾¹ç•Œç»„ä»¶
```tsx
// components/ErrorBoundary.tsx
import React from 'react';
import { captureException } from '@/lib/sentry';

interface Props {
  children: React.ReactNode;
  fallback?: React.ReactNode;
}

interface State {
  hasError: boolean;
}

export class ErrorBoundary extends React.Component<Props, State> {
  constructor(props: Props) {
    super(props);
    this.state = { hasError: false };
  }

  static getDerivedStateFromError() {
    return { hasError: true };
  }

  componentDidCatch(error: Error, errorInfo: React.ErrorInfo) {
    captureException(error, errorInfo);
  }

  render() {
    if (this.state.hasError) {
      return this.props.fallback || (
        <div className="error-container">
          <h2>Something went wrong</h2>
          <button onClick={() => this.setState({ hasError: false })}>
            Try again
          </button>
        </div>
      );
    }

    return this.props.children;
  }
}
```

</div>

### ç¼“å­˜ä¼˜åŒ–

<div className="caching">

#### CDNç¼“å­˜é…ç½®
```typescript
// pages/_middleware.ts
import { NextResponse } from 'next/server';
import type { NextRequest } from 'next/server';

export function middleware(request: NextRequest) {
  const response = NextResponse.next();

  // é™æ€èµ„æºç¼“å­˜
  if (request.nextUrl.pathname.startsWith('/_next/static/')) {
    response.headers.set(
      'Cache-Control',
      'public, max-age=31536000, immutable'
    );
  }

  // APIå“åº”ç¼“å­˜
  if (request.nextUrl.pathname.startsWith('/api/')) {
    response.headers.set(
      'Cache-Control',
      'public, s-maxage=60, stale-while-revalidate=300'
    );
  }

  return response;
}
```

#### é™æ€ç”Ÿæˆä¼˜åŒ–
```typescript
// lib/cache.ts
import { redis } from './redis';

export async function getCachedData(key: string) {
  const cached = await redis.get(key);
  if (cached) {
    return JSON.parse(cached);
  }
  return null;
}

export async function setCachedData(
  key: string,
  data: any,
  ttl: number = 3600
) {
  await redis.setex(key, ttl, JSON.stringify(data));
}
```

</div>

export const styles = {
  optimization: {
    backgroundColor: '#f6f8fa',
    padding: '1rem',
    borderRadius: '8px',
    marginBottom: '1rem'
  },
  deploymentSteps: {
    borderLeft: '3px solid #1a73e8',
    paddingLeft: '1rem'
  },
  monitoring: {
    backgroundColor: '#f0f7ff',
    padding: '1rem',
    borderRadius: '8px'
  }
};
